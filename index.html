<!DOCTYPE html>
<html lang="en">
<head>
	<title>Play Snake Circuit</title>
<link rel="manifest" href="manifest.webmanifest">
<script src="www/app.js" async></script>
<script src="www/aframe.min.js"></script>
<script src="www/aframe-environment-component.min.js"></script>
<script src="www/aframe-crawling-cursor.js"></script>
<script src="www/aframe-aabb-collider-component.min.js"></script>
<script src="www/aframe-geometry-merger-component.min.js"></script>
<script src="js/mvmt.js"></script>
<script src="js/mvmt-vr.js"></script>
<script src="js/textures.js"></script>
<script src="js/score_and_body.js"></script>
<script src="js/fruit-create.js"></script>
<script src="js/fruit-action.js"></script>

</head>
<body>
  <a-scene renderer="colorManagement: true;" reflection="directionalLight"  stats >
	<a-assets>
		<a-asset-item id="apple" src="/assets/apple.glb"></a-asset-item>
		<!-- <a-asset-item id="pineapple" src="/assets/pineapple.glb"></a-asset-item>
		<a-asset-item id="cherries" src="/assets/cherries.glb"></a-asset-item> -->

		<img id="sand" src="/assets/Ring/SAND/sand.jpg">
		<img id="albedo" src="/assets/Ring/albedo.png">
		<img id="ao" src="/assets/Ring/ao.png">
		<img id="height1" src="/assets/Ring/height.png">
		<img id="normal" src="/assets/Ring/normal.png">
		<img id="roughness" src="/assets/Ring/roughness.png">
		<img id="combined" src="/assets/Ring/combined.png">
		
		<a-mixin id="fruit-apple" scale="0.8 0.8 0.8" gltf-model="#apple"  ></a-mixin>
		<!-- <a-mixin id="fruit-pineapple" scale="0.7 0.7 0.7"  gltf-model="#pineapple"></a-mixin>		
		<a-mixin id="fruit-cherries" scale="0.8 0.8 0.8" gltf-model="#cherries"></a-mixin>	 -->
		
	</a-assets>
	<a-camera wasd-controls-enabled="false"></a-camera>
	<a-entity environment="preset: egypt; ground: flat; dressingAmount: 2"></a-entity>

	<!--material="opacity: 0.8; side: double; color: #F36601" -->
	<!--src: #albedo; displacementMap: #height1
					ambientOcclusionMap: #ao; normalMap: #normal; roughnessMap: #roughness
							crawling-cursor="target: #fruit-apple"
	-->

	<a-entity id="player-wrapper2" score="0" >
				<a-entity 
					id="fruit_applepool" pool__applepool="mixin: fruit-apple; size: 3"
					class="fruit" data-aabb-collider-dynamic="true" fruit-action 
					
					animation__normalSpin="property: rotation; from: 0 0 20; to: 0 360 20; easing: linear; loop: true; dur: 3000; pauseEvents: hitstart; resumeEvents: hitend"
					animation__eatenCycleSize="property: scale; from: 0.8 0.8 0.8; to: 1.1 1.1 1.1; loop: 1; dir: alternate; easing: linear; dur: 100; startEvents: hitstart"
					animation__eatenSpin="property: rotation; from: 0 0 20; to: 0 360 20; easing: linear; loop: true; dur: 150; startEvents: hitstart; pauseEvents: hitend"
				></a-entity>
	<!-- 
		<a-entity 
			id="fruit_pineapplepool" pool__pineapplepool="mixin: fruit-pineapple; size: 3"
			class="fruit" data-aabb-collider-dynamic="true" fruit-action

			animation__normalSpin="property: rotation; from: 0 0 20; to: 0 -360 20; easing: linear; loop: true; dur: 2500; pauseEvents: hitstart; resumeEvents: hitend"
			animation__eatenCycleSize="property: scale; from: 0.7 0.7 0.7; to: 1.1 1.1 1.1; loop: 1; dir: alternate; easing: linear; dur: 100; startEvents: hitstart"
			animation__eatenSpin="property: rotation; from: 0 0 20; to: 0 360 20; easing: linear; loop: true; dur: 150; startEvents: hitstart; pauseEvents: hitend"
	></a-entity> 

	<a-entity 
		id="fruit_cherriespool" pool__cherriespool="mixin: fruit-cherries; size: 3"
		class="fruit" data-aabb-collider-dynamic="true" fruit-action

		animation__normalSpin="property: rotation; from: 0 0 20; to: 0 360 20; easing: linear; loop: true; dur: 3000; pauseEvents: hitstart; resumeEvents: hitend"
		animation__eatenCycleSize="property: scale; from: 0.8 0.8 0.8; to: 1.3 1.3 1.3; loop:1; dir: alternate; easing: linear; dur: 100; startEvents: hitstart"
		animation__eatenSpin="property: rotation; from: 0 0 20; to: 0 360 20; easing: linear; loop: 1; dur: 150; startEvents: hitstart"
	></a-entity> -->

	</a-entity>

	<a-entity laser-controls="hand: left"></a-entity>
		
    <a-cylinder 
		id="gameworld" position="0 1.6 0" open-ended="true"
		radius-bottom="0.2" radius-top="0.2" height="1" radius="0.7"
		material="src: #sand; opacity: 0.30; side: double; repeat: 3 1"		
		crawling-cursor__snake="target: #snake" 
		crawling-cursor__apple="target: #fruit_applepool"
	></a-cylinder>

	<!-- 				laser-controls="hand: left"-->
	<!--  <a-entity tracked-controls="controller: 0; idPrefix: OpenVR"></a-entity> mvmt="orbit: #player-wrapper" -->
		<a-entity id="player-wrapper" >
			<a-sphere	
				id="snake"
				tracked-controls="controller: 0; idPrefix: OpenVR; hand: left" mvmtvr="orbit: #gameworld"
				color="Firebrick" radius="0.06" segments-width="3" segments-height="2" phi-length="90" phi-start="90" 
				blending="none" bodyCount="0"
				aabb-collider="objects: .fruit; debug: true" data-aabb-collider-dynamic="true"
				score_and_body="orbit: #player-wrapper2" 
			 	fruit-create="orbit: #player-wrapper2"
			></a-sphere>
		</a-entity>
	

		<a-entity 
			id="snakebodies" geometry-merger="preserveOriginal: false" material="color: #AAA" 
			class="ignore-ray"
		></a-entity>
		
  </a-scene>
</body>
</html>